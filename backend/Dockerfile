FROM maven:3.9.9-eclipse-temurin-21

ARG FRONTEND_URL
ARG UNSUBSCRIBE_URI
ARG MAIL_USERNAME
ARG MAIL_PASSWORD
ARG DB_PROD_USERNAME
ARG DB_PROD_PASSWORD
ARG DB_PROD_URL

ENV FRONTEND_URL=$FRONTEND_URL
ENV UNSUBSCRIBE_URI=$UNSUBSCRIBE_URI
ENV MAIL_USERNAME=$MAIL_USERNAME
ENV MAIL_PASSWORD=$MAIL_PASSWORD
ENV DB_PROD_USERNAME=$DB_PROD_USERNAME
ENV DB_PROD_PASSWORD=$DB_PROD_PASSWORD
ENV DB_PROD_URL=$DB_PROD_URL

EXPOSE 8080

WORKDIR /app
COPY . .
RUN mvn clean package
ENTRYPOINT ["java", "-jar", "-Dspring.profiles.active=common,prod", "target/notice-tracker-0.0.1-SNAPSHOT.jar"]
